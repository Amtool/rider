// typography
//
// @author  firede(firede@firede.us)


// hide text
// @see http://goo.gl/EglZN
hide-text()
    color: transparent
    font: 0 / 0 a
    text-shadow: none


// ellipsis
// support multi line (webkit only)
ellipsis($line = 1)
    overflow: hidden
    text-overflow: ellipsis

    if $line == 1
        white-space: nowrap
    else
        display: -webkit-box
        -webkit-line-clamp: $line
        -webkit-box-orient: vertical


// clearfix
// @see http://h5bp.com/q
clearfix()
    &:after,
    &:before
        content: ' '
        display: table
    &:after
        clear: both


// font face
// iOS/Android used ttf, Mobile IE 10 used woff.
font-face($font-family, $font-path)

    if is-url($font-path)
        error('Only support local $font-path, please using `@font-face` instead.')

    // 字体类型与对应的format,顺序排列
    $font-formats = {
        'eot': 'embedded-opentype',
        'woff': 'woff',
        'woff2': 'woff2',
        'ttf': 'truetype',
        'svg': 'svg'
    }

    $usable-types = ()
    $src-array = ()
    $font-files = {}

    // 取出本地可用的字体
    for $type in keys($font-formats)
        $font-files[$type] = $font-path + '.' + $type

        if file-exists($font-files[$type])
            push($usable-types, $type)

    // 无任何可用字体则报错
    if length($usable-types) == 0
        error('Web fonts `' + $font-family + '` not exists!');

    // 合并字体src
    for $type in $usable-types
        if $type == 'eot'
            $src-url = $font-files[$type] + '?#iefix'
        else if $type == 'svg'
            $src-url = $font-files[$type] + '#' + $font-family
        else
            $src-url = $font-files[$type]
        $src-str = s('%s format(%s)', url($src-url), $font-formats[$type])
        push($src-array, $src-str)

    $str = join(', ', $src-array)

    @font-face
        font-family: $font-family
        if 'eot' in $usable-types
            src: url($font-files['eot'])
        src: unquote($str)
        font-weight: normal
        font-style: normal
