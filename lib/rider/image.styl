// 图片
//
// @author  firede(firede@firede.us)
// @desc    image helpers


@require 'setting'
@require 'retina'
@require 'typography'

bg($src, $width = null, $height = null)

    if not file-exists($src)
        error('$src 必须为本地已存在的图片路径：' + $src)

    // 获取图片尺寸
    $img-size = image-size($src)
    $width = $img-size[0] if $width == null
    $height = $img-size[1] if $height == null

    background-image: url($src)
    background-size: $width $height

    for $dppx, $index in $-image-dppx-range
        // 忽略 dppx 为 1 的情况
        if $dppx != 1
            $computed-src = get-retina-src($src, $dppx, $-image-dppx-separator)
            if file-exists($computed-src)
                // 质量优先模式
                if $-image-dppx-quality-first && $dppx > 1.5
                    $computed-dppx = $dppx - 0.5
                else
                    $computed-dppx = $dppx

                +retina($computed-dppx)
                    background-image: url($computed-src)


ir($src, $x = null, $y = null, $width = null, $height = null)
    hide-text()

    background-position-x: $x if $x != null && $y == null
    background-position-y: $y if $x == null && $y != null
    background-position: $x $y if $x != null && $y != null

    bg($src, $width, $height)
// // image replace
// // hide text and set background image
// ir($path, $x = 0, $y = 0, $width = auto, $height = auto, $dppx = 2)
//     bg($path, $width, $height, $dppx)

//     if $x != 0 && $y == 0
//         $y = null
//     if $x != 0
//         background-position: $x $y

//     hide-text()
